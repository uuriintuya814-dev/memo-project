<!DOCTYPE html>
<html lang="mn">

<head>
    <meta charset="UTF-8">

    <title>Memo Dashboard</title>
    <link rel="stylesheet" href="common.css">
    <!-- jQuery & SweetAlert -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

</head>

<body>
    <!-- PROFILE BAR -->
    <div class="profile-bar">
        <div class="profile-pink">
            <div class="profile-img">
                <img src="images/pro.jpg" alt="">
            </div>
            <div class="text">
                <div style="font-weight: bold;">User Name </div>
                <div style="color: gray; font-size: 12px;">LV. MASTER KING</div>
                <div id="process"></div>
            </div>

        </div>
        <div class="point">
            YOUR POINT IS ... / 10000
        </div>
    </div>
    <a href="games.html" id="back"><button>БУЦАХ</button></a>


    <!--BUTTONS AND COIN-->
    <div class="header">

        <div class="currency-container">
            <div class="currency">
                <img src="images/coin.png" alt="Gold Coin">
                <span>4,892</span>
            </div>
            <div class="currency">
                <img src="images/diamond.png" alt="Blue Crystal">
                <span>8,219</span>
            </div>
        </div>

        <div class="btns">
            <a href="dashboard.html"><button>Профайл</button></a>
            <a href="games.html"><button class="active">Тоглоом</button></a>
            <a href="info.html"><button>Мэдээлэл</button></a>
            <a href="about.html"><button>Бидний тухай</button></a>
        </div>
    </div>


    <!--SPIN WHEEL-->
    <div class="container">
        <h4 align="center" class="thought">Алийг нь тоглохоо <br> мэдэхгүй байна уу?</h4>
        <div class="row">
            <div class="col-xs-12" align="center">
                <div id="wheel">
                    <canvas id="canvas" width="260" height="260"></canvas>
                </div>
            </div>
        </div>
        <div class="row" style="margin-top: 20px;">
            <div class="col-xs-12" align="center">
                <button onclick="startSpin()" class="btn">Эргүүлэх</button>
            </div>
        </div>
    </div>

    <!-- SPIN RESPONSE -->
    <div id="resultModal">
        <div class="modal-content">
            <div class="modal-header">
            </div>
            <div class="modal-body" id="modalBodyText">
                <!-- Үр дүн энд гарна -->
            </div>
            <div class="modal-footer">
                <button onclick="hideModal()" class="btn">Тоглох</button>
                <button onclick="hideModal()" class="btn">Гарах</button>
            </div>
        </div>
    </div>



    <div class="game-container">
        <div class="game">
            <div class="wrapper">
                <ul class="cards" id="cards-container">
                    <!-- 36 cards will be generated by JS -->
                </ul>
            </div>
        </div>
        <div class="dashboard">
            <h1>Мемо карт <br>(2 тоглогч)</h1> <hr>
            <div class="scoreboard">
                <span>Тоглогч 1 оноо: <b id="score1">0</b></span> 
                <span>Тоглогч 2 оноо: <b id="score2">0</b></span>
            </div> <hr>
            <div class="turn-indicator">Тоглогчийн ээлж: <br><b id="turn">Тоглогч 1</b></div>
        </div>
    </div>

    <style>
        hr{
            width: 80%;
            border: 1px solid black;
        }
        span{
            font-size: 20px
        }
        .game-container {
            position: absolute;
            left: calc(20% + 2.8rem);
            right: 5%;
            height: calc(100% - 6rem - 40px);
            display: flex;
            align-items: center;
            max-width: none;
            box-sizing: border-box;
            margin-top: calc(4rem + 40px);
            gap: 2%;
        }

        .game {
            width: 60%;
            height: 100%;
            border: none;
            position: relative;
            background-clip: padding-box;
        }

        .game::before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #fc55ab, #c267fe, #ffb3d1, #ff99bf);
            border-radius: 22px;
            /* Slightly larger than container */
            z-index: -1;
            animation: borderGlow 4s ease infinite alternate;
        }

        /* Subtle glow animation */
        @keyframes borderGlow {
            0% {
                opacity: 0.8;
                box-shadow: 0 0 10px rgba(252, 85, 171, 0.5);
            }

            100% {
                opacity: 1;
                box-shadow: 0 0 20px rgba(194, 103, 254, 0.8);
            }
        }


        .wrapper {
            width: 100%;
            height: 100%;
            background: rgba(255 255 255 / 0.9);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            box-sizing: border-box;
        }

        .cards {
            width: 100%;
            height: 100%;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-content: space-between;
            box-sizing: border-box;
            padding: 0;
            margin: 0;
        }

        .card {
            cursor: pointer;
            list-style: none;
            user-select: none;
            position: relative;
            perspective: 1000px;
            transform-style: preserve-3d;
            width: calc(100% / 6 - 10px);
            height: calc(100% / 6 - 10px);
            border-radius: 10px;
            box-shadow: 0 4px 7px rgba(0, 0, 0, 0.1);
            background: #fff;
            transition: transform 0.3s ease;
        }

        .card.shake {
            animation: shake 0.35s ease-in-out;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20% {
                transform: translateX(-8px);
            }

            40% {
                transform: translateX(8px);
            }

            60% {
                transform: translateX(-5px);
            }

            80% {
                transform: translateX(5px);
            }
        }

        .card .view {
            width: 100%;
            height: 100%;
            position: absolute;
            border-radius: 10px;
            background: #fff;
            pointer-events: none;
            backface-visibility: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s linear;
        }

        .card .front-view img {
            width: 65px;
            user-select: none;
        }

        .card .back-view img {
            max-width: 60px;
            user-select: none;
            pointer-events: none;
        }

        .card .back-view {
            transform: rotateY(-180deg);
            background: #f0f0f0;
        }

        .card.flip .back-view {
            transform: rotateY(0);
            pointer-events: auto;
        }

        .card.flip .front-view {
            transform: rotateY(180deg);
        }

        .dashboard {
            width: 38%;
            height: 100%;
            padding: 20px;
            border-radius: 20px;

            box-sizing: border-box;
            font-size: 20px;
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            border: none;
            position: relative;
            background-clip: padding-box;
            color: rgb(61, 0, 61);
        }

        .dashboard::before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #fc55ab, #c267fe, #ffb3d1, #ff99bf);
            border-radius: 22px;
            /* Slightly larger than container */
            z-index: -1;
            animation: borderGlow 4s ease infinite alternate;
        }

        h1 {
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
        }

        .scoreboard {
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            font-weight: 600;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .scoreboard span {
            user-select: none;
        }

        .turn-indicator {
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 24px;
            color: #fc55ab;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
    </style>

    <script>
        const cardsContainer = document.getElementById('cards-container');

        // Create 36 cards dynamically (6x6)
        for (let i = 0; i < 36; i++) {
            const li = document.createElement('li');
            li.classList.add('card');
            li.innerHTML = `
            <div class="view front-view">
                <img src="images/img-0.png" alt="question-icon" />
            </div>
            <div class="view back-view">
                <img src="" alt="card-image" />
            </div>`;
            cardsContainer.appendChild(li);
        }

        const cards = document.querySelectorAll('.card');
        let matched = 0;
        let cardOne, cardTwo;
        let disableDeck = false;

        let score1 = 0;
        let score2 = 0;
        let playerTurn = 1; // 1 or 2

        const score1El = document.getElementById('score1');
        const score2El = document.getElementById('score2');
        const turnEl = document.getElementById('turn');

        function flipCard({ target: clickedCard }) {
            if (disableDeck) return;
            clickedCard = clickedCard.closest('.card');
            if (!clickedCard || clickedCard === cardOne || clickedCard.classList.contains('flip')) return;

            clickedCard.classList.add('flip');

            if (!cardOne) {
                cardOne = clickedCard;
            } else {
                cardTwo = clickedCard;
                disableDeck = true;

                const img1 = cardOne.querySelector('.back-view img').src;
                const img2 = cardTwo.querySelector('.back-view img').src;

                if (img1 === img2) {
                    // Matched
                    matched++;
                    if (playerTurn === 1) {
                        score1++;
                        score1El.innerText = score1;
                    } else {
                        score2++;
                        score2El.innerText = score2;
                    }
                    cardOne.removeEventListener('click', flipCard);
                    cardTwo.removeEventListener('click', flipCard);
                    resetTurn();

                    if (matched === 18) {
                        setTimeout(() => alert(`Game over! Player 1: ${score1} | Player 2: ${score2}`), 300);
                    }
                } else {
                    // Not matched
                    setTimeout(() => {
                        cardOne.classList.add('shake');
                        cardTwo.classList.add('shake');
                    }, 300);

                    setTimeout(() => {
                        cardOne.classList.remove('flip', 'shake');
                        cardTwo.classList.remove('flip', 'shake');
                        resetTurn();
                        switchTurn();
                    }, 1000);
                }
            }
        }

        function resetTurn() {
            [cardOne, cardTwo] = [null, null];
            disableDeck = false;
        }

        function switchTurn() {
            playerTurn = playerTurn === 1 ? 2 : 1;
            turnEl.innerText = `Player ${playerTurn}`;
        }

        function shuffleCard() {
            matched = 0;
            score1 = 0;
            score2 = 0;
            score1El.innerText = 0;
            score2El.innerText = 0;
            playerTurn = 1;
            turnEl.innerText = 'Player 1';

            // Prepare pairs (18 pairs for 36 cards)
            let arr = [];
            for (let i = 1; i <= 18; i++) {
                arr.push(i);
                arr.push(i);
            }
            arr.sort(() => Math.random() - 0.5);

            cards.forEach((card, i) => {
                card.classList.remove('flip');
                const imgTag = card.querySelector('.back-view img');
                imgTag.src = `images/img-${arr[i]}.jpg`; // Fixed image path syntax
                card.addEventListener('click', flipCard);
            });
        }

        shuffleCard();
    </script>
    <script src="common.js"></script>
    <script src="userData.js"></script>
</body>

</html>